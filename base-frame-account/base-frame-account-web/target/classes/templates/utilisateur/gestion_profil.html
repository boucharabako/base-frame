<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org" 
      layout:decorator="template">
    <head>
        <title>Sante-soft</title>
        <link th:href="@{/plugins/jstree/style.css}" rel="stylesheet" type="text/css" />
        <link th:href="@{/plugins/multiselect/css/multi-select.css}"  rel="stylesheet" type="text/css" />
        <link th:href="@{/plugins/bootstrap-select/css/bootstrap-select.min.css}" rel="stylesheet" />
        <!-- DataTables -->
        <link th:href="@{/plugins/datatables/dataTables.bootstrap4.min.css}" rel="stylesheet" type="text/css" />
        <link th:href="@{/plugins/datatables/buttons.bootstrap4.min.css}" rel="stylesheet" type="text/css" />
        <!-- Responsive datatable examples -->
        <link th:href="@{/plugins/datatables/responsive.bootstrap4.min.css}" rel="stylesheet" type="text/css" /> 
        <script th:src="@{/js/controllers/profileController.js}"></script>
        <style type="text/css">
            .side-menu.left {

                
            }
            .footer {
                
            }
            .content-page {
                
            }
        </style>
    </head> 
    <body>
        <div layout:fragment="left">
            <ul class="metismenu left-sidenav-menu">
                <li>
                    <a href="javascript: void(0);"><i class="fas fa-user-shield"> </i><span>Habilitations</span><span class="menu-arrow"><i class="mdi mdi-chevron-right"></i></span></a>
                    <ul class="nav-second-level" aria-expanded="false" style="width: 300px;">

                        <li class="nav-item"><a class="nav-link" th:href="@{/parametre/utilisateur}"><i class="fas fa-users"></i>Gestion des utilisateurs</a></li>
                        <!--<li class="nav-item"><a class="nav-link" href="#"><i class="ti-control-record"></i>Gestion des groupes</a></li>-->
                        <li class="nav-item"><a class="nav-link" th:href="@{/parametre/profil}"><i class="fas fa-id-card"></i> Gestion des profils</a></li> 
                    </ul>
                </li>
            </ul>
        </div>
        <div layout:fragment="content"  id="welcomen" data-id="profils" data-ng-cloak="">
            <div class="row" ng-controller="profileController" data-ng-cloak="">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="mt-0 header-title">Filtres</h4>


                            <form method="POST" class="form-horizontal well">
                                <fieldset>
                                    <div class="repeater-default">
                                        <div data-repeater-list="car">
                                            <div data-repeater-item="">
                                                <div class="form-group row d-flex align-items-end">

<!--                                                    <div class="col-sm-3">
                                                        <label class="control-label">Code</label>
                                                        <input type="text" name="car[0][model]"  class="form-control" ng-model="searchObject.code">
                                                    </div>end col

                                                    <div class="col-sm-3">
                                                        <label class="control-label">Libellé</label>
                                                        <input type="text" name="car[0][model]"  class="form-control" ng-model="searchObject.intitule">
                                                    </div>end col-->
                                                    <div class="col-sm-5">
                                                        <label class="control-label">Mot clé</label>
                                                        <input type="text"   class="form-control" ng-model="searchObject.mc">
                                                    </div><!--end col-->

                                                    

                                                    <div class="col-sm-1">
                                                        <span data-repeater-delete="" class="btn btn-gradient-primary btn-sm">
                                                            <span class="mdi mdi-filter" ng-click="listeDesProfil()"></span> 
                                                        </span>
                                                    </div><!--end col-->
                                                </div><!--end row-->
                                            </div><!--end /div-->


                                        </div><!--end repet-list-->

                                    </div> <!--end repeter-->                                           
                                </fieldset><!--end fieldset-->
                            </form><!--end form-->
                        </div><!--end card-body-->
                    </div><!--end card-->
                </div>  
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">

                            <h4 class="mt-0 header-title">Profils</h4>


                            <div id="child_rows_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">
                                <div class="row">
                                    <div class="col-sm-12 col-md-6">
                                        <div class="dataTables_length" id="child_rows_length">
                                            <label>Affiché 
                                                <select name="child_rows_length" aria-controls="child_rows" ng-change="changePageSize()" class="custom-select custom-select-sm form-control form-control-sm" ng-model="pageSizeSelect"
                                                        data-ng-options="nb for nb in pageSizes" id="pageSizeSelect">

                                                </select> 
                                                lignes par page
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-sm-12 col-md-6">
                                        <div id="child_rows_filter" class="dataTables_filter">
                                            <div class="form-group mb-0 row">
                                                <div class="col-sm-12">
                                                    <button type="button" class="btn btn-gradient-primary" ng-click="addProfil()"><i class="fas fa-plus"></i></button>


                                                </div><!--end col-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <table id="child_rows" class="table table-striped table-bordered dt-responsive nowrap dataTable no-footer dtr-inline" style="border-collapse: collapse; border-spacing: 0px; width: 100%;" role="grid" aria-describedby="child_rows_info">
                                            <thead>
                                                <tr role="row">
                                                    <th class="details-control sorting_disabled" rowspan="1" colspan="1" style="width: 10%;" aria-label="">Code</th>
                                                    <th class=" " tabindex="0" aria-controls="child_rows" rowspan="1" colspan="1" style="width: 15%;" aria-sort="ascending" aria-label="Name: activate to sort column descending">Libellé</th>
                                                    <th class="" tabindex="0" aria-controls="child_rows" rowspan="1" colspan="1" style="width: 25%;" aria-label="Position: activate to sort column ascending">Décription</th>
                                                    <th class="" tabindex="0" aria-controls="child_rows" rowspan="1" colspan="1" style="width: 15%;" aria-label="Office: activate to sort column ascending">Etat</th>
                                                    <th class="" tabindex="0" aria-controls="child_rows" rowspan="1" colspan="1" style="width: 15%;" aria-label="Salary: activate to sort column ascending">Actions</th></tr>
                                            </thead>
                                            <tbody>

                                                <tr role="row" class="odd" data-ng-repeat="pr in listeObjetProfil track by $index">
                                                    <!--<td class=" details-control" tabindex="0"></td>-->
                                                    <td class="sorting_1" data-ng-bind="pr.code"></td>
                                                    <td class="sorting_1" data-ng-bind="pr.intitule"></td>
                                                    <td data-ng-bind="pr.description"></td>
                                                    <td >
                                                        <div class="btn-group mb-4" style="display: flex;">
                                                            <div > 


                                                                <button type="button" style=" height: 30px; margin-right: 10px;text-align: center; background-color: {{pr.etatObject.codeCouleur}}; color: {{u.etatObject.codeCouleurText}};" class="btn btn-primary "><span data-ng-bind="pr.libelleEtat" ></span>
                                                                </button>

                                                            </div >                                               
                                                            <div class="m-r-5">                                               
                                                                
                                                                <select ng-if=" pr.listActions.length > 1"  ng-change="changerEtats(actionProfil.idActionPermise, pr)"  class=" custom-select-sm form-control " ng-model="actionProfil"
                                                                        data-ng-options="action.libelleAction for action in pr.listActions" id="actionProfil">

                                                                </select> 
                                                            </div>
                                                            <div > 
                                                                <button type="button" ng-if=" pr.listActions.length == 1" style=" height: 30px; margin-right: 10px;text-align: center;background-color: {{pr.listActions[0].codeCouleur}}; color:{{opp.actionObject.codeCouleurText}};" class="btn btn-primary " ng-click="changerEtats(pr.listActions[0].idActionPermise, pr)"><span data-ng-bind="pr.listActions[0].libelleAction" ></span><i ></i>
                                                                </button>

                                                            </div>

                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="dropdown d-inline-block float-right">
                                                            <a style="height: 30px; margin-top: -20px;margin-bottom: -200px;" class="nav-link dropdown-toggle arrow-none" id="dLabel4" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                                                                <i class="fas fa-ellipsis-v font-20 text-muted"></i>
                                                            </a>
                                                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dLabel4">
                                                                <a class="dropdown-item" href="#" style="color: green" data-ng-click="detailProfilV(pr.id)"><i class="fas fa-eye" style="color: green"></i> Détail</a>
                                                                <a class="dropdown-item" href="#" style="color: black" data-ng-click="editProfilV(pr.id)"><i class="fas fa-pencil-alt" style="color: black"></i> Modifier</a>
                                                                <a class="dropdown-item" href="#" style="color: red" data-ng-click="deleteProfil(pr.id)"><i class="fas fa-trash-alt" style="color: red"></i>  Supprimer</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" ng-if="listeObjetProfil.length == 0" >
                                        <br></br>
                                        <br></br>
                                        <center style="font-style: italic;">Il n'existe pas encore de d'opposition</center>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-5" data-ng-if="listeObjetProfil.length !== 0">
                                        <div class="dataTables_info" id="child_rows_info" role="status" aria-live="polite">Affichage de {{pageSizeSelect * (listPage.number + 1) - pageSizeSelect + 1}} Ã  {{pageSizeSelect * (listPage.number + 1)}} de {{totalElements}} lignes</div>

                                    </div>
                                    <div class="col-sm-12 col-md-7" data-ng-if="listeObjetProfil.length !== 0">
                                        <div class="dataTables_paginate paging_simple_numbers" id="child_rows_paginate">
                                            <ul class="pagination">
                                                <li class="paginate_button page-item previous" id="child_rows_previous"  >
                                                    <button href="#" aria-controls="child_rows" data-dt-idx="0" tabindex="0" data-ng-disabled="listPage.number === 0"  data-ng-click="paginate(pageSizeSelect, 1)" class="page-link" ><i class="mdi mdi-skip-backward" ></i></button>
                                                </li>
                                                <li class="paginate_button page-item previous" id="child_rows_previous"  >
                                                    <button href="#" aria-controls="child_rows" data-dt-idx="0" tabindex="0" data-ng-disabled="listPage.number === 0" data-ng-click="paginate(pageSizeSelect, listPage.number)" class="page-link" ><i class="mdi mdi-skip-previous" ></i></button>
                                                </li>
                                                <div ng-repeat="page in sequence">
                                                    <div ng-if="listPage.number === (page - 1)">
                                                        <li class="paginate_button page-item active">
                                                            <button href="#" aria-controls="child_rows" data-dt-idx="1" tabindex="0" class="page-link">{{page}}</button>
                                                        </li> 
                                                    </div>

                                                </div>

                                                <li class="paginate_button page-item nex" id="child_rows_next" >
                                                    <button href="#" aria-controls="child_rows" data-dt-idx="2" tabindex="0" class="page-link" data-ng-disabled="listPage.number + 1 === listPage.totalPages" data-ng-click="paginate(pageSizeSelect, listPage.number + 2)" ><i class="mdi mdi-skip-next" ></i></button>
                                                </li>
                                                <li class="paginate_button page-item nex" id="child_rows_next" >
                                                    <button href="#" aria-controls="child_rows" data-dt-idx="2" tabindex="0" class="page-link" data-ng-disabled="listPage.number + 1 === listPage.totalPages" data-ng-click="paginate(pageSizeSelect, listPage.totalPages)" ><i class="mdi mdi-skip-forward" ></i></button>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>        
                        </div>
                    </div>
                </div> <!-- end col -->

                <div  th:include="utilisateur/detailProfil">

                </div>
                <div  th:include="modalConfirme">

                </div>
                
            </div>

        </div>
        <script th:src="@{/js/controllers/profilController.js}"></script>
        <!-- jQuery  -->
        <script th:src="@{/assets/js/jquery.min.js}"></script>
        <script th:src="@{/assets/js/jquery-ui.min.js}"></script>
        <script th:src="@{/assets/js/bootstrap.bundle.min.js}"></script>
        <script th:src="@{/assets/js/metismenu.min.js}"></script>
        <script th:src="@{/assets/js/waves.js}"></script>
        <script th:src="@{/assets/js/feather.min.js}"></script>
        <script th:src="@{/assets/js/jquery.slimscroll.min.js}"></script>    

        <!-- Required datatable js -->
        <script th:src="@{/plugins/datatables/jquery.dataTables.min.js}"></script>
        <script th:src="@{/plugins/datatables/dataTables.bootstrap4.min.js}"></script>
        <!-- Buttons examples -->
        <script th:src="@{/plugins/datatables/dataTables.buttons.min.js}"></script>
        <script th:src="@{/plugins/datatables/buttons.bootstrap4.min.js}"></script>
        <script th:src="@{/plugins/datatables/jszip.min.js}"></script>
        <script th:src="@{/plugins/datatables/pdfmake.min.js}"></script>
        <script th:src="@{/plugins/datatables/vfs_fonts.js}"></script>
        <script th:src="@{/plugins/datatables/buttons.html5.min.js}"></script>
        <script th:src="@{/plugins/datatables/buttons.print.min.js}"></script>
        <script th:src="@{/plugins/datatables/buttons.colVis.min.js}"></script>
        <!-- Responsive examples -->
        <script th:src="@{/plugins/datatables/dataTables.responsive.min.js}"></script>
        <script th:src="@{/plugins/datatables/responsive.bootstrap4.min.js}"></script>
        <script th:src="@{/assets/pages/jquery.datatable.init.js}"></script>

        <!-- App js -->
        <script th:src="@{/assets/js/app.js}"></script>

        <th:block layout:fragment="scripts">
            <script type="text/javascript">

                $(function () {
                    viderLeContainer();
                });
            </script>
            <script type="text/javascript">
                $('body').on('shown.bs.modal', '.modal', function () {
                    $(this).find('.mySelecDoc').each(function () {
                        var dropdownParent = $(document.body);
                        if ($(this).parents('.modal.in:first').length !== 0)
                            dropdownParent = $(this).parents('.modal.in:first');
                        $(this).select2({
                            dropdownParent: dropdownParent
                                    // ...
                        });
                    });
                });

                function verifierCaracteres(event) {
                    var keyCode = event.which ? event.which : event.keyCode;
                    var touche = String.fromCharCode(keyCode);
                    var champ = document.getElementById('code_profil');
                    var caracteres = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_@.';
                    if (caracteres.indexOf(touche) >= 0) {
                        champ.value += touche;
                    }

                }
                ;

                //                $(document).ready(function () {
                //
                //                    $("#entiteactive").on("select_node.jstree",
                //                            function (evt, data) {
                //                                $('#entiteOrg').val(data.node.id);
                //                                $('#labelEntite').attr('data-id', data.node.id);
                //                                loadEntite();
                //                            }
                //                    );
                //
                //                });

            </script>
        </th:block>
    </body>

</html>